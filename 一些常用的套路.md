# 客户端连接数据库

## 遵守JDBC(支持SQL)

**按照JDBC的套路连接数据库**

> 1. 获取Connection
>    准备四个参数(不需要的可以不写)：
>    1. url
>    2. driver(省略，根据url自动加载驱动)
>    3. user
>    4. password
> 2. 准备sql，使用Connection预编译sql，获取PreparedStatement
> 3. 还可能会向预编译以后的sql中添加占位符参数
> 4. 执行sql
> 5. 如果是查询，遍历返回值

```java
public class FatClientDemo {
    public static void main(String[] args) throws SQLException {
        //准备url（FatClient）
        String url = "jdbc:phoenix:hadoop102:2181";
            //准备url（ThinClient）
            //String url = ThinClientUtil.getConnectionUrl("hadoop102", 8765);
        //获取Connection
        Connection connection = DriverManager.getConnection(url);
        //预编译sql
        PreparedStatement preparedStatement = connection.prepareStatement("select * from student1");
        //执行sql
        ResultSet resultSet = preparedStatement.executeQuery();
        //遍历返回值
        while (resultSet.next()){
            System.out.println(resultSet.getString(1) + ":" + resultSet.getString(2) + ":" +
                    resultSet.getString("addr"));
        }
        //关闭资源
        connection.close();
    }
}
```

## 使用Druid从练级池中获取连接对象

> 1. 创建连接池对象
> 2. 连接池的初始化
>    1. 创建paramMap配置并赋值
>    2. 使用Druid连接池对象
> 3. 从连接池中获取连接对象

```scala
object JDBCUtil {
    // 创建连接池对象
    var dataSource:DataSource = init()

    // 连接池的初始化
    def init():DataSource = {

        val paramMap = new java.util.HashMap[String, String]()
        paramMap.put("driverClassName", PropertiesUtil.getValue("jdbc.driver.name"))
        paramMap.put("url", PropertiesUtil.getValue("jdbc.url"))
        paramMap.put("username", PropertiesUtil.getValue("jdbc.user"))
        paramMap.put("password", PropertiesUtil.getValue("jdbc.password"))
        paramMap.put("maxActive", PropertiesUtil.getValue("jdbc.datasource.size"))

        // 使用Druid连接池对象
        DruidDataSourceFactory.createDataSource(paramMap)
    }

    // 从连接池中获取连接对象
    def getConnection(): Connection = {
        dataSource.getConnection
    }
}
```







## 不遵守JDBC

> 1. 新建一个客户端
> 2. 可用客户端与服务建立连接
> 3. 客户端发送命令到服务端执行
> 4. 如果是读命令，接收服务端返回的结果
> 5. 关闭客户端

### 连接Redis

```scala
```





# Kafka

## Kafka生产者

> 1. 创建kafka生产者的配置对象
> 2. 给kafka配置对象添加配置信息
>    1. 设置bootstrap.servers（必须）
>    2. 设置key 和 value的序列化器（必须）
>    3. 设置batchsize
>    4. 设置linger.ms
>    5. 设置RecordAccumulator缓冲区大小
>    6. 设置compression.type压缩格式
>    7. 设置生产者是否是一个幂等生产者
> 3. 创建kafka生产者对象
> 4. 调用send方法，发送消息
> 5. 关闭资源

```java
public class CustomProducerParameters {
    public static void main(String[] args) throws InterruptedException {
        // 1. 创建kafka生产者的配置对象
        Properties properties = new Properties();

        // 2. 给kafka配置对象添加配置信息：bootstrap.servers
        properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "hadoop102:9092");
        
        // key,value序列化（必须）：key.serializer，value.serializer
        properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");
        properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");

        // batch.size：批次大小，默认16K
        properties.put(ProducerConfig.BATCH_SIZE_CONFIG, 16384);

        // linger.ms：等待时间，默认0
        properties.put(ProducerConfig.LINGER_MS_CONFIG, 1);

        // RecordAccumulator：缓冲区大小，默认32M：buffer.memory
        properties.put(ProducerConfig.BUFFER_MEMORY_CONFIG, 33554432);

        // compression.type：压缩，默认none，可配置值gzip、snappy、lz4和zstd
properties.put(ProducerConfig.COMPRESSION_TYPE_CONFIG,"snappy");

        // 3. 创建kafka生产者对象
        KafkaProducer<String, String> kafkaProducer = new KafkaProducer<String, String>(properties);

        // 4. 调用send方法,发送消息
        for (int i = 0; i < 5; i++) {
            kafkaProducer.send(new ProducerRecord<>("first","atguigu" + i));
        }

        // 5. 关闭资源
        kafkaProducer.close();
    }
}
```



# Json

```
fastjson:  阿里巴巴推出
           特点：   静态方法。

           核心类：  JSON
               {}字符串转java对象:   JSON.parseObject()
                       返回值:  JSONObject(Map)   或   T
               []字符串转java对象:   JSON.parseArray()
                       返回值:   JSONArray(List)   或  List[T]


               java对象转字符串:   JSON.toJSONString()


gson:      google推出
          特点：   实例方法

          核心类：  Gson

               java对象转字符串:   Gson.toJSON()
```





